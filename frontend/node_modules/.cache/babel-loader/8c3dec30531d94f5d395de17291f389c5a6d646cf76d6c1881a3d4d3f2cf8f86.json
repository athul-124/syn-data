{"ast":null,"code":"import { create } from 'zustand';\nimport axios from 'axios';\nconst API_BASE = 'http://localhost:8000'; // Make sure this points to your FastAPI backend\n\nconst useStore = create((set, get) => ({\n  // Auth state\n  user: null,\n  isAuthenticated: false,\n  // Data state\n  uploadedFile: null,\n  uploadedFiles: [],\n  // Add this array\n  previewData: null,\n  generationTasks: [],\n  currentTask: null,\n  // UI state\n  loading: false,\n  error: null,\n  // Actions\n  setLoading: loading => set({\n    loading\n  }),\n  setError: error => set({\n    error\n  }),\n  // File upload\n  uploadFile: async file => {\n    set({\n      loading: true,\n      error: null\n    });\n    try {\n      console.log('Starting upload for file:', file.name);\n      const formData = new FormData();\n      formData.append('file', file);\n      console.log('Uploading to:', `${API_BASE}/upload`);\n      const response = await axios.post(`${API_BASE}/upload`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        },\n        timeout: 10000 // Reduce to 10 seconds\n      });\n      console.log('Upload successful:', response.data);\n      set(state => ({\n        uploadedFile: response.data,\n        uploadedFiles: [...(state.uploadedFiles || []), response.data],\n        loading: false\n      }));\n      return response.data;\n    } catch (error) {\n      console.error('Upload failed:', error.message);\n      let errorMessage = 'Upload failed';\n      if (error.code === 'ECONNABORTED') {\n        errorMessage = 'Request timed out. Check if backend is running on port 8000.';\n      } else if (error.code === 'ERR_NETWORK') {\n        errorMessage = 'Cannot connect to backend. Make sure it\\'s running on port 8000.';\n      }\n      set({\n        error: errorMessage,\n        loading: false\n      });\n      throw error;\n    }\n  },\n  // Generate preview\n  generatePreview: async (fileId, rows = 10) => {\n    set({\n      loading: true,\n      error: null\n    });\n    try {\n      const response = await axios.post(`${API_BASE}/preview`, {\n        file_id: fileId,\n        n_rows: rows\n      });\n      set({\n        previewData: response.data,\n        loading: false\n      });\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response$data;\n      set({\n        error: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.detail) || 'Preview failed',\n        loading: false\n      });\n      throw error;\n    }\n  },\n  // Start generation task\n  startGeneration: async params => {\n    set({\n      loading: true,\n      error: null\n    });\n    try {\n      const response = await axios.post(`${API_BASE}/generate-async`, params);\n      const newTask = response.data;\n      set(state => ({\n        generationTasks: [...state.generationTasks, newTask],\n        currentTask: newTask,\n        loading: false\n      }));\n      return newTask;\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      set({\n        error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.detail) || 'Generation failed',\n        loading: false\n      });\n      throw error;\n    }\n  },\n  // Poll task status\n  pollTaskStatus: async taskId => {\n    try {\n      const response = await axios.get(`${API_BASE}/tasks/${taskId}/status`);\n      const updatedTask = response.data;\n      set(state => {\n        var _state$currentTask;\n        return {\n          generationTasks: state.generationTasks.map(task => task.id === taskId ? updatedTask : task),\n          currentTask: ((_state$currentTask = state.currentTask) === null || _state$currentTask === void 0 ? void 0 : _state$currentTask.id) === taskId ? updatedTask : state.currentTask\n        };\n      });\n      return updatedTask;\n    } catch (error) {\n      console.error('Failed to poll task status:', error);\n    }\n  },\n  // Get all tasks\n  fetchTasks: async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/tasks`);\n      set({\n        generationTasks: response.data\n      });\n      return response.data;\n    } catch (error) {\n      set({\n        error: 'Failed to fetch tasks'\n      });\n    }\n  },\n  // Add these functions to your store\n  checkTaskStatus: async taskId => {\n    try {\n      const response = await axios.get(`${API_BASE}/task-status/${taskId}`);\n      const updatedTask = response.data;\n      set(state => ({\n        currentTask: updatedTask,\n        generationTasks: state.generationTasks.map(task => task.task_id === taskId ? updatedTask : task)\n      }));\n      return updatedTask;\n    } catch (error) {\n      console.error('Failed to check task status:', error);\n    }\n  }\n}));\nexport default useStore;","map":{"version":3,"names":["create","axios","API_BASE","useStore","set","get","user","isAuthenticated","uploadedFile","uploadedFiles","previewData","generationTasks","currentTask","loading","error","setLoading","setError","uploadFile","file","console","log","name","formData","FormData","append","response","post","headers","timeout","data","state","message","errorMessage","code","generatePreview","fileId","rows","file_id","n_rows","_error$response","_error$response$data","detail","startGeneration","params","newTask","_error$response2","_error$response2$data","pollTaskStatus","taskId","updatedTask","_state$currentTask","map","task","id","fetchTasks","checkTaskStatus","task_id"],"sources":["E:/ATHUL KRISHNA M B/Project/SynData plus/syn-data/frontend/src/store/useStore.js"],"sourcesContent":["import { create } from 'zustand';\nimport axios from 'axios';\n\nconst API_BASE = 'http://localhost:8000'; // Make sure this points to your FastAPI backend\n\nconst useStore = create((set, get) => ({\n  // Auth state\n  user: null,\n  isAuthenticated: false,\n  \n  // Data state\n  uploadedFile: null,\n  uploadedFiles: [], // Add this array\n  previewData: null,\n  generationTasks: [],\n  currentTask: null,\n  \n  // UI state\n  loading: false,\n  error: null,\n  \n  // Actions\n  setLoading: (loading) => set({ loading }),\n  setError: (error) => set({ error }),\n  \n  // File upload\n  uploadFile: async (file) => {\n    set({ loading: true, error: null });\n    try {\n      console.log('Starting upload for file:', file.name);\n      \n      const formData = new FormData();\n      formData.append('file', file);\n      \n      console.log('Uploading to:', `${API_BASE}/upload`);\n      \n      const response = await axios.post(`${API_BASE}/upload`, formData, {\n        headers: { \n          'Content-Type': 'multipart/form-data' \n        },\n        timeout: 10000 // Reduce to 10 seconds\n      });\n      \n      console.log('Upload successful:', response.data);\n      \n      set(state => ({ \n        uploadedFile: response.data,\n        uploadedFiles: [...(state.uploadedFiles || []), response.data],\n        loading: false \n      }));\n      \n      return response.data;\n    } catch (error) {\n      console.error('Upload failed:', error.message);\n      \n      let errorMessage = 'Upload failed';\n      if (error.code === 'ECONNABORTED') {\n        errorMessage = 'Request timed out. Check if backend is running on port 8000.';\n      } else if (error.code === 'ERR_NETWORK') {\n        errorMessage = 'Cannot connect to backend. Make sure it\\'s running on port 8000.';\n      }\n      \n      set({ \n        error: errorMessage,\n        loading: false \n      });\n      throw error;\n    }\n  },\n  \n  // Generate preview\n  generatePreview: async (fileId, rows = 10) => {\n    set({ loading: true, error: null });\n    try {\n      const response = await axios.post(`${API_BASE}/preview`, {\n        file_id: fileId,\n        n_rows: rows\n      });\n      \n      set({ \n        previewData: response.data,\n        loading: false \n      });\n      \n      return response.data;\n    } catch (error) {\n      set({ \n        error: error.response?.data?.detail || 'Preview failed',\n        loading: false \n      });\n      throw error;\n    }\n  },\n  \n  // Start generation task\n  startGeneration: async (params) => {\n    set({ loading: true, error: null });\n    try {\n      const response = await axios.post(`${API_BASE}/generate-async`, params);\n      \n      const newTask = response.data;\n      set(state => ({ \n        generationTasks: [...state.generationTasks, newTask],\n        currentTask: newTask,\n        loading: false \n      }));\n      \n      return newTask;\n    } catch (error) {\n      set({ \n        error: error.response?.data?.detail || 'Generation failed',\n        loading: false \n      });\n      throw error;\n    }\n  },\n  \n  // Poll task status\n  pollTaskStatus: async (taskId) => {\n    try {\n      const response = await axios.get(`${API_BASE}/tasks/${taskId}/status`);\n      const updatedTask = response.data;\n      \n      set(state => ({\n        generationTasks: state.generationTasks.map(task => \n          task.id === taskId ? updatedTask : task\n        ),\n        currentTask: state.currentTask?.id === taskId ? updatedTask : state.currentTask\n      }));\n      \n      return updatedTask;\n    } catch (error) {\n      console.error('Failed to poll task status:', error);\n    }\n  },\n  \n  // Get all tasks\n  fetchTasks: async () => {\n    try {\n      const response = await axios.get(`${API_BASE}/tasks`);\n      set({ generationTasks: response.data });\n      return response.data;\n    } catch (error) {\n      set({ error: 'Failed to fetch tasks' });\n    }\n  },\n  \n  // Add these functions to your store\n  checkTaskStatus: async (taskId) => {\n    try {\n      const response = await axios.get(`${API_BASE}/task-status/${taskId}`);\n      const updatedTask = response.data;\n      \n      set(state => ({\n        currentTask: updatedTask,\n        generationTasks: state.generationTasks.map(task => \n          task.task_id === taskId ? updatedTask : task\n        )\n      }));\n      \n      return updatedTask;\n    } catch (error) {\n      console.error('Failed to check task status:', error);\n    }\n  }\n}));\n\nexport default useStore;\n\n\n\n\n\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,SAAS;AAChC,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,QAAQ,GAAG,uBAAuB,CAAC,CAAC;;AAE1C,MAAMC,QAAQ,GAAGH,MAAM,CAAC,CAACI,GAAG,EAAEC,GAAG,MAAM;EACrC;EACAC,IAAI,EAAE,IAAI;EACVC,eAAe,EAAE,KAAK;EAEtB;EACAC,YAAY,EAAE,IAAI;EAClBC,aAAa,EAAE,EAAE;EAAE;EACnBC,WAAW,EAAE,IAAI;EACjBC,eAAe,EAAE,EAAE;EACnBC,WAAW,EAAE,IAAI;EAEjB;EACAC,OAAO,EAAE,KAAK;EACdC,KAAK,EAAE,IAAI;EAEX;EACAC,UAAU,EAAGF,OAAO,IAAKT,GAAG,CAAC;IAAES;EAAQ,CAAC,CAAC;EACzCG,QAAQ,EAAGF,KAAK,IAAKV,GAAG,CAAC;IAAEU;EAAM,CAAC,CAAC;EAEnC;EACAG,UAAU,EAAE,MAAOC,IAAI,IAAK;IAC1Bd,GAAG,CAAC;MAAES,OAAO,EAAE,IAAI;MAAEC,KAAK,EAAE;IAAK,CAAC,CAAC;IACnC,IAAI;MACFK,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEF,IAAI,CAACG,IAAI,CAAC;MAEnD,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEN,IAAI,CAAC;MAE7BC,OAAO,CAACC,GAAG,CAAC,eAAe,EAAE,GAAGlB,QAAQ,SAAS,CAAC;MAElD,MAAMuB,QAAQ,GAAG,MAAMxB,KAAK,CAACyB,IAAI,CAAC,GAAGxB,QAAQ,SAAS,EAAEoB,QAAQ,EAAE;QAChEK,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,OAAO,EAAE,KAAK,CAAC;MACjB,CAAC,CAAC;MAEFT,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEK,QAAQ,CAACI,IAAI,CAAC;MAEhDzB,GAAG,CAAC0B,KAAK,KAAK;QACZtB,YAAY,EAAEiB,QAAQ,CAACI,IAAI;QAC3BpB,aAAa,EAAE,CAAC,IAAIqB,KAAK,CAACrB,aAAa,IAAI,EAAE,CAAC,EAAEgB,QAAQ,CAACI,IAAI,CAAC;QAC9DhB,OAAO,EAAE;MACX,CAAC,CAAC,CAAC;MAEH,OAAOY,QAAQ,CAACI,IAAI;IACtB,CAAC,CAAC,OAAOf,KAAK,EAAE;MACdK,OAAO,CAACL,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAACiB,OAAO,CAAC;MAE9C,IAAIC,YAAY,GAAG,eAAe;MAClC,IAAIlB,KAAK,CAACmB,IAAI,KAAK,cAAc,EAAE;QACjCD,YAAY,GAAG,8DAA8D;MAC/E,CAAC,MAAM,IAAIlB,KAAK,CAACmB,IAAI,KAAK,aAAa,EAAE;QACvCD,YAAY,GAAG,kEAAkE;MACnF;MAEA5B,GAAG,CAAC;QACFU,KAAK,EAAEkB,YAAY;QACnBnB,OAAO,EAAE;MACX,CAAC,CAAC;MACF,MAAMC,KAAK;IACb;EACF,CAAC;EAED;EACAoB,eAAe,EAAE,MAAAA,CAAOC,MAAM,EAAEC,IAAI,GAAG,EAAE,KAAK;IAC5ChC,GAAG,CAAC;MAAES,OAAO,EAAE,IAAI;MAAEC,KAAK,EAAE;IAAK,CAAC,CAAC;IACnC,IAAI;MACF,MAAMW,QAAQ,GAAG,MAAMxB,KAAK,CAACyB,IAAI,CAAC,GAAGxB,QAAQ,UAAU,EAAE;QACvDmC,OAAO,EAAEF,MAAM;QACfG,MAAM,EAAEF;MACV,CAAC,CAAC;MAEFhC,GAAG,CAAC;QACFM,WAAW,EAAEe,QAAQ,CAACI,IAAI;QAC1BhB,OAAO,EAAE;MACX,CAAC,CAAC;MAEF,OAAOY,QAAQ,CAACI,IAAI;IACtB,CAAC,CAAC,OAAOf,KAAK,EAAE;MAAA,IAAAyB,eAAA,EAAAC,oBAAA;MACdpC,GAAG,CAAC;QACFU,KAAK,EAAE,EAAAyB,eAAA,GAAAzB,KAAK,CAACW,QAAQ,cAAAc,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBV,IAAI,cAAAW,oBAAA,uBAApBA,oBAAA,CAAsBC,MAAM,KAAI,gBAAgB;QACvD5B,OAAO,EAAE;MACX,CAAC,CAAC;MACF,MAAMC,KAAK;IACb;EACF,CAAC;EAED;EACA4B,eAAe,EAAE,MAAOC,MAAM,IAAK;IACjCvC,GAAG,CAAC;MAAES,OAAO,EAAE,IAAI;MAAEC,KAAK,EAAE;IAAK,CAAC,CAAC;IACnC,IAAI;MACF,MAAMW,QAAQ,GAAG,MAAMxB,KAAK,CAACyB,IAAI,CAAC,GAAGxB,QAAQ,iBAAiB,EAAEyC,MAAM,CAAC;MAEvE,MAAMC,OAAO,GAAGnB,QAAQ,CAACI,IAAI;MAC7BzB,GAAG,CAAC0B,KAAK,KAAK;QACZnB,eAAe,EAAE,CAAC,GAAGmB,KAAK,CAACnB,eAAe,EAAEiC,OAAO,CAAC;QACpDhC,WAAW,EAAEgC,OAAO;QACpB/B,OAAO,EAAE;MACX,CAAC,CAAC,CAAC;MAEH,OAAO+B,OAAO;IAChB,CAAC,CAAC,OAAO9B,KAAK,EAAE;MAAA,IAAA+B,gBAAA,EAAAC,qBAAA;MACd1C,GAAG,CAAC;QACFU,KAAK,EAAE,EAAA+B,gBAAA,GAAA/B,KAAK,CAACW,QAAQ,cAAAoB,gBAAA,wBAAAC,qBAAA,GAAdD,gBAAA,CAAgBhB,IAAI,cAAAiB,qBAAA,uBAApBA,qBAAA,CAAsBL,MAAM,KAAI,mBAAmB;QAC1D5B,OAAO,EAAE;MACX,CAAC,CAAC;MACF,MAAMC,KAAK;IACb;EACF,CAAC;EAED;EACAiC,cAAc,EAAE,MAAOC,MAAM,IAAK;IAChC,IAAI;MACF,MAAMvB,QAAQ,GAAG,MAAMxB,KAAK,CAACI,GAAG,CAAC,GAAGH,QAAQ,UAAU8C,MAAM,SAAS,CAAC;MACtE,MAAMC,WAAW,GAAGxB,QAAQ,CAACI,IAAI;MAEjCzB,GAAG,CAAC0B,KAAK;QAAA,IAAAoB,kBAAA;QAAA,OAAK;UACZvC,eAAe,EAAEmB,KAAK,CAACnB,eAAe,CAACwC,GAAG,CAACC,IAAI,IAC7CA,IAAI,CAACC,EAAE,KAAKL,MAAM,GAAGC,WAAW,GAAGG,IACrC,CAAC;UACDxC,WAAW,EAAE,EAAAsC,kBAAA,GAAApB,KAAK,CAAClB,WAAW,cAAAsC,kBAAA,uBAAjBA,kBAAA,CAAmBG,EAAE,MAAKL,MAAM,GAAGC,WAAW,GAAGnB,KAAK,CAAClB;QACtE,CAAC;MAAA,CAAC,CAAC;MAEH,OAAOqC,WAAW;IACpB,CAAC,CAAC,OAAOnC,KAAK,EAAE;MACdK,OAAO,CAACL,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACrD;EACF,CAAC;EAED;EACAwC,UAAU,EAAE,MAAAA,CAAA,KAAY;IACtB,IAAI;MACF,MAAM7B,QAAQ,GAAG,MAAMxB,KAAK,CAACI,GAAG,CAAC,GAAGH,QAAQ,QAAQ,CAAC;MACrDE,GAAG,CAAC;QAAEO,eAAe,EAAEc,QAAQ,CAACI;MAAK,CAAC,CAAC;MACvC,OAAOJ,QAAQ,CAACI,IAAI;IACtB,CAAC,CAAC,OAAOf,KAAK,EAAE;MACdV,GAAG,CAAC;QAAEU,KAAK,EAAE;MAAwB,CAAC,CAAC;IACzC;EACF,CAAC;EAED;EACAyC,eAAe,EAAE,MAAOP,MAAM,IAAK;IACjC,IAAI;MACF,MAAMvB,QAAQ,GAAG,MAAMxB,KAAK,CAACI,GAAG,CAAC,GAAGH,QAAQ,gBAAgB8C,MAAM,EAAE,CAAC;MACrE,MAAMC,WAAW,GAAGxB,QAAQ,CAACI,IAAI;MAEjCzB,GAAG,CAAC0B,KAAK,KAAK;QACZlB,WAAW,EAAEqC,WAAW;QACxBtC,eAAe,EAAEmB,KAAK,CAACnB,eAAe,CAACwC,GAAG,CAACC,IAAI,IAC7CA,IAAI,CAACI,OAAO,KAAKR,MAAM,GAAGC,WAAW,GAAGG,IAC1C;MACF,CAAC,CAAC,CAAC;MAEH,OAAOH,WAAW;IACpB,CAAC,CAAC,OAAOnC,KAAK,EAAE;MACdK,OAAO,CAACL,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACtD;EACF;AACF,CAAC,CAAC,CAAC;AAEH,eAAeX,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}